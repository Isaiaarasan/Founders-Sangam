import{c as ae,d as be,g as ue,h as pe,r as te,j as t,m as g,i as se,S as H,s as ge,a as ye,l as ve}from"./index-Dsm2NKI-.js";import{C as ne}from"./circle-alert-30rCiQZ2.js";import{M as we}from"./message-square-DQsssvgw.js";import{A as ke}from"./arrow-left-CUmXCws5.js";const je=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],de=ae("circle-question-mark",je);const Ne=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_e=ae("refresh-cw",Ne);const Ce=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Se=ae("zap",Ce),Me=()=>{const e=be.c(62),l=ue(),X=pe(),[B,ce]=te.useState(!1),[r,re]=te.useState(0);let y;e[0]!==X.state?(y=X.state||{},e[0]=X.state,e[1]=y):y=e[1];const{data:s}=y,v=s?.reason||"Payment could not be processed",G=s?.ticketId,K=s?.eventId;let w,k;e[2]!==r?(w=()=>{if(r>0){const a=setTimeout(()=>re(r-1),1e3);return()=>clearTimeout(a)}},k=[r],e[2]=r,e[3]=w,e[4]=k):(w=e[3],k=e[4]),te.useEffect(w,k);let j;e[5]!==s?.errorCode||e[6]!==K||e[7]!==v||e[8]!==G?(j=()=>{let a=K;if(!a){const oe=se(H.LAST_PAYMENT_CONTEXT);if(oe&&(a=oe.eventId),!a){const ie=se(H.PAYMENT_RETRY_CONTEXT);ie&&(a=ie.eventId)}}a||(a="69382673cb27d7173ac1dfc5",console.warn("No eventId found in state or localStorage, using default"));const le=`https://founders-sangam.vercel.app/event/${a}/register`,fe=se(H.PAYMENT_RETRY_CONTEXT)?.failedAttempts||0,he={isRetry:!0,timestamp:new Date().toISOString(),failedAttempts:fe+1,lastFailureReason:v,lastErrorCode:s?.errorCode,ticketId:G,eventId:a};ge(H.PAYMENT_RETRY_CONTEXT,he),re(30),ce(!0),console.log(`Redirecting to event registration: ${le}`),window.location.href=le},e[5]=s?.errorCode,e[6]=K,e[7]=v,e[8]=G,e[9]=j):j=e[9];const Q=j,me=Ee;let N;e[10]===Symbol.for("react.memo_cache_sentinel")?(N=[{icon:t.jsx(Se,{size:20,className:"text-yellow-500"}),title:"Insufficient Balance",description:"Your account doesn't have enough funds for this transaction"},{icon:t.jsx(ye,{size:20,className:"text-orange-500"}),title:"Session Expired",description:"Payment session timed out. Please try again"},{icon:t.jsx(ne,{size:20,className:"text-red-500"}),title:"Network Error",description:"Connection lost during payment. Please check your internet"},{icon:t.jsx(de,{size:20,className:"text-blue-500"}),title:"Invalid Details",description:"Payment details don't match. Verify and try again"}],e[10]=N):N=e[10];const xe=N;let _;e[11]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-red-500/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none"}),e[11]=_):_=e[11];let C;e[12]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 w-fit",children:[t.jsx("span",{className:"flex h-2 w-2 rounded-full bg-red-500 animate-pulse"}),t.jsx("span",{className:"text-xs font-bold text-red-700 dark:text-red-400 uppercase tracking-wide",children:"Payment Failed"})]}),e[12]=C):C=e[12];let S,E;e[13]===Symbol.for("react.memo_cache_sentinel")?(S={scale:[1,1.05,1]},E={duration:2,repeat:1/0},e[13]=S,e[14]=E):(S=e[13],E=e[14]);let T,R;e[15]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(g.div,{animate:S,transition:E,className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 mx-auto",children:t.jsx(ne,{size:40,className:"text-red-600 dark:text-red-400"})}),T=t.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white",children:"Payment Failed"}),e[15]=T,e[16]=R):(T=e[15],R=e[16]);const U=v;let o;e[17]!==U?(o=t.jsxs("div",{className:"text-center space-y-4",children:[R,t.jsxs("div",{children:[T,t.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-3 leading-relaxed",children:U})]})]}),e[17]=U,e[18]=o):o=e[18];let i;e[19]!==s?(i=s?.errorCode&&t.jsx("div",{className:"bg-white/50 dark:bg-slate-900/50 p-4 rounded-xl border border-red-200 dark:border-red-800",children:t.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:["Error Code:"," ",t.jsx("span",{className:"font-bold text-red-600 dark:text-red-400",children:s.errorCode})]})}),e[19]=s,e[20]=i):i=e[20];let n;e[21]!==o||e[22]!==i?(n=t.jsxs("div",{className:"md:w-1/2 p-8 md:p-12 bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-950/20 dark:to-orange-950/20 border-r border-red-100 dark:border-red-900/30 flex flex-col justify-center relative overflow-hidden",children:[_,t.jsxs("div",{className:"max-w-md mx-auto w-full space-y-8 relative z-10",children:[C,o,i]})]}),e[21]=o,e[22]=i,e[23]=n):n=e[23];let P,A;e[24]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx("div",{className:"absolute top-[-20%] right-[-20%] w-[500px] h-[500px] bg-red-500/5 rounded-full blur-[100px] pointer-events-none"}),A=t.jsx("div",{className:"absolute bottom-[-20%] left-[-20%] w-[500px] h-[500px] bg-amber-500/5 rounded-full blur-[100px] pointer-events-none"}),e[24]=P,e[25]=A):(P=e[24],A=e[25]);let z;e[26]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[t.jsx(de,{size:24,className:"text-amber-500"}),"What might have gone wrong?"]}),e[26]=z):z=e[26];let I;e[27]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsxs("div",{className:"space-y-4",children:[z,t.jsx("div",{className:"grid grid-cols-1 gap-3",children:xe.slice(0,2).map(Te)})]}),e[27]=I):I=e[27];const V=B||r>0,W=B?1:1.02;let d;e[28]!==W?(d={scale:W},e[28]=W,e[29]=d):d=e[29];const Z=B?1:.98;let c;e[30]!==Z?(c={scale:Z},e[30]=Z,e[31]=c):c=e[31];const J=r>0?"animate-spin":"";let m;e[32]!==J?(m=t.jsx(_e,{size:20,className:J}),e[32]=J,e[33]=m):m=e[33];const ee=r>0?`Retry in ${r}s`:"Try Payment Again";let x;e[34]!==ee?(x=t.jsx("span",{children:ee}),e[34]=ee,e[35]=x):x=e[35];let f;e[36]!==Q||e[37]!==V||e[38]!==d||e[39]!==c||e[40]!==m||e[41]!==x?(f=t.jsxs(g.button,{onClick:Q,disabled:V,whileHover:d,whileTap:c,className:"w-full py-4 bg-gradient-to-r from-amber-500 to-red-500 hover:from-amber-600 hover:to-red-600 disabled:from-slate-300 disabled:to-slate-300 dark:disabled:from-slate-700 dark:disabled:to-slate-700 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all disabled:cursor-not-allowed disabled:opacity-60 flex items-center justify-center gap-3",children:[m,x]}),e[36]=Q,e[37]=V,e[38]=d,e[39]=c,e[40]=m,e[41]=x,e[42]=f):f=e[42];let M,Y;e[43]===Symbol.for("react.memo_cache_sentinel")?(M={scale:1.02},Y={scale:.98},e[43]=M,e[44]=Y):(M=e[43],Y=e[44]);let D;e[45]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsxs(g.button,{onClick:me,whileHover:M,whileTap:Y,className:"w-full py-4 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-900 dark:text-white rounded-xl font-bold text-lg shadow-md hover:shadow-lg transition-all flex items-center justify-center gap-3 border border-slate-200 dark:border-slate-700",children:[t.jsx(we,{size:20}),"Contact Support"]}),e[45]=D):D=e[45];let h;e[46]!==l?(h=()=>l("/events"),e[46]=l,e[47]=h):h=e[47];let L,O;e[48]===Symbol.for("react.memo_cache_sentinel")?(L={scale:1.02},O={scale:.98},e[48]=L,e[49]=O):(L=e[48],O=e[49]);let $;e[50]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(ke,{size:20}),e[50]=$):$=e[50];let b;e[51]!==h?(b=t.jsxs(g.button,{onClick:h,whileHover:L,whileTap:O,className:"w-full py-4 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-900 dark:text-white rounded-xl font-bold text-lg shadow-sm hover:shadow-md transition-all border border-slate-200 dark:border-slate-700 flex items-center justify-center gap-3",children:[$,"Back to Events"]}),e[51]=h,e[52]=b):b=e[52];let u;e[53]!==f||e[54]!==b?(u=t.jsxs("div",{className:"space-y-3",children:[f,D,b]}),e[53]=f,e[54]=b,e[55]=u):u=e[55];let F;e[56]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800",children:t.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 text-center leading-relaxed",children:[t.jsx(ve,{size:16,className:"inline mr-2 text-blue-500"}),"Your registration details are saved. You can retry payment anytime."]})}),e[56]=F):F=e[56];let p;e[57]!==u?(p=t.jsxs("div",{className:"md:w-1/2 p-8 md:p-12 flex flex-col justify-center items-center bg-white dark:bg-slate-950 relative overflow-hidden",children:[P,A,t.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10",children:[I,u,F]})]}),e[57]=u,e[58]=p):p=e[58];let q;return e[59]!==n||e[60]!==p?(q=t.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-950 flex flex-col md:flex-row overflow-hidden",children:[n,p]}),e[59]=n,e[60]=p,e[61]=q):q=e[61],q};function Ee(){window.location.href="mailto:support@founders-sangam.com?subject=Payment%20Failure%20Support"}function Te(e,l){return t.jsxs(g.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:l*.1},className:"flex items-start gap-3 p-3 rounded-lg bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800",children:[t.jsx("div",{className:"mt-0.5",children:e.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white text-sm",children:e.title}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:e.description})]})]},l)}export{Me as default};
