import{c as ce,d as re,r as f,j as t,U as ue,e as pe,P as be,f as fe,u as he,g as ye,h as ge,i as ie,S as X,m as J,C as ve,M as Ne,k as le,s as oe,b as ke}from"./index-Dsm2NKI-.js";import{S as je,g as we,r as Te,A as Re}from"./eventService-Bto2UDFT.js";import{B as Ee}from"./building-2-Bwr8MEGv.js";import{C as me}from"./circle-alert-30rCiQZ2.js";import{T as Se}from"./triangle-alert-A1ufvaN2.js";const Ce=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],_e=ce("hash",Ce);const Ie=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],de=ce("tag",Ie),G=r=>{const e=re.c(17),{label:p,type:o,name:N,placeholder:l,value:h,onChange:s,icon:m,disabled:x}=r;let c;e[0]!==p?(c=t.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 ml-1",children:p}),e[0]=p,e[1]=c):c=e[1];let y;e[2]!==x||e[3]!==N||e[4]!==s||e[5]!==l||e[6]!==o||e[7]!==h?(y=t.jsx("input",{type:o,name:N,placeholder:l,value:h,onChange:s,disabled:x,className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-400/50 focus:border-amber-400 transition-all text-slate-900 dark:text-white placeholder:text-slate-400 font-medium disabled:opacity-50 disabled:cursor-not-allowed"}),e[2]=x,e[3]=N,e[4]=s,e[5]=l,e[6]=o,e[7]=h,e[8]=y):y=e[8];let g;e[9]!==m?(g=m&&t.jsx(m,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-amber-500 transition-colors pointer-events-none",size:18}),e[9]=m,e[10]=g):g=e[10];let b;e[11]!==y||e[12]!==g?(b=t.jsxs("div",{className:"relative group",children:[y,g]}),e[11]=y,e[12]=g,e[13]=b):b=e[13];let v;return e[14]!==c||e[15]!==b?(v=t.jsxs("div",{className:"space-y-1.5",children:[c,b]}),e[14]=c,e[15]=b,e[16]=v):v=e[16],v},Pe=r=>{const e=re.c(76),{event:p,onSubmit:o,loading:N,savedData:l,isRetry:h}=r,s=h===void 0?!1:h,m=l?.name||"",x=l?.companyName||"",c=l?.email||"",y=l?.contact||"",g=l?.ticketType||"",b=l?.quantity||1;let v;e[0]!==m||e[1]!==x||e[2]!==c||e[3]!==y||e[4]!==g||e[5]!==b?(v={name:m,companyName:x,email:c,contact:y,ticketType:g,quantity:b},e[0]=m,e[1]=x,e[2]=c,e[3]=y,e[4]=g,e[5]=b,e[6]=v):v=e[6];const[a,E]=f.useState(v),[T,Z]=f.useState(0);let _;e[7]!==p.ticketTypes?(_=p.ticketTypes||[],e[7]=p.ticketTypes,e[8]=_):_=e[8];const n=_;let S;e[9]!==a.ticketType||e[10]!==n[0]||e[11]!==n.length?(S=()=>{n.length>0&&!a.ticketType&&E(j=>({...j,ticketType:n[0].name}))},e[9]=a.ticketType,e[10]=n[0],e[11]=n.length,e[12]=S):S=e[12];let i;e[13]!==n?(i=[n],e[13]=n,e[14]=i):i=e[14],f.useEffect(S,i);let d;e[15]!==l||e[16]!==n[0]||e[17]!==n.length?(d=()=>{l&&E({name:l.name||"",companyName:l.companyName||"",email:l.email||"",contact:l.contact||"",ticketType:l.ticketType||(n.length>0?n[0].name:""),quantity:l.quantity||1})},e[15]=l,e[16]=n[0],e[17]=n.length,e[18]=d):d=e[18];let k;e[19]!==l?(k=[l],e[19]=l,e[20]=k):k=e[20],f.useEffect(d,k);let u,R;e[21]!==a.quantity||e[22]!==a.ticketType||e[23]!==n?(u=()=>{const j=n.find(w=>w.name===a.ticketType);if(j){const w=a.quantity===""?0:parseInt(a.quantity)||0;Z(j.price*w)}},R=[a.ticketType,a.quantity,n],e[21]=a.quantity,e[22]=a.ticketType,e[23]=n,e[24]=u,e[25]=R):(u=e[24],R=e[25]),f.useEffect(u,R);let C;e[26]===Symbol.for("react.memo_cache_sentinel")?(C=j=>{const{name:w,value:L}=j.target;E(se=>({...se,[w]:L}))},e[26]=C):C=e[26];const B=C;let U;e[27]===Symbol.for("react.memo_cache_sentinel")?(U=j=>{const w=j.target.value;if(w===""){E(Ae);return}const L=parseInt(w);!isNaN(L)&&L>=0&&E(se=>({...se,quantity:L}))},e[27]=U):U=e[27];const xe=U;let Q;e[28]!==a||e[29]!==o||e[30]!==T?(Q=j=>{j.preventDefault();const w=a.quantity===""||a.quantity<1?1:a.quantity;o({...a,quantity:w,amount:T})},e[28]=a,e[29]=o,e[30]=T,e[31]=Q):Q=e[31];const ee=Q;let I;e[32]!==s?(I=s&&t.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-start gap-3",children:[t.jsx(me,{size:20,className:"text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:"Payment Retry Mode"}),t.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-0.5",children:'Your registration details are locked. Click "Retry Payment" below to complete your payment.'})]})]}),e[32]=s,e[33]=I):I=e[33];let P;e[34]!==a.name||e[35]!==s?(P=t.jsx("div",{className:"md:col-span-2",children:t.jsx(G,{label:"Full Name",name:"name",type:"text",placeholder:"Your Name",value:a.name,onChange:B,icon:ue,disabled:s})}),e[34]=a.name,e[35]=s,e[36]=P):P=e[36];let A;e[37]!==a.companyName||e[38]!==s?(A=t.jsx("div",{className:"md:col-span-2",children:t.jsx(G,{label:"Company Name / Brand Name",name:"companyName",type:"text",placeholder:"Your Company or Brand",value:a.companyName,onChange:B,icon:Ee,disabled:s})}),e[37]=a.companyName,e[38]=s,e[39]=A):A=e[39];let F;e[40]!==a.email||e[41]!==s?(F=t.jsx("div",{children:t.jsx(G,{label:"Email Address",name:"email",type:"email",placeholder:"Your mail",value:a.email,onChange:B,icon:pe,disabled:s})}),e[40]=a.email,e[41]=s,e[42]=F):F=e[42];let q;e[43]!==a.contact||e[44]!==s?(q=t.jsx("div",{children:t.jsx(G,{label:"Phone Number",name:"contact",type:"tel",placeholder:"9876543210",value:a.contact,onChange:B,icon:be,disabled:s})}),e[43]=a.contact,e[44]=s,e[45]=q):q=e[45];let H;e[46]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 ml-1",children:"Ticket Type"}),e[46]=H):H=e[46];let z;e[47]!==a.ticketType||e[48]!==s||e[49]!==n?(z=t.jsx("div",{children:t.jsxs("div",{className:"space-y-1.5",children:[H,t.jsx("div",{className:"relative group",children:n.length===1?t.jsxs("div",{className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl text-slate-900 dark:text-white font-medium flex items-center",children:[t.jsxs("span",{className:"flex-1",children:[n[0].name," - â‚¹",n[0].price]}),t.jsx(de,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",size:18})]}):t.jsxs(t.Fragment,{children:[t.jsx("select",{name:"ticketType",value:a.ticketType,onChange:B,disabled:s,className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-400/50 focus:border-amber-400 transition-all text-slate-900 dark:text-white font-medium appearance-none disabled:opacity-50 disabled:cursor-not-allowed",children:n.map(Fe)}),t.jsx(de,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",size:18})]})})]})}),e[47]=a.ticketType,e[48]=s,e[49]=n,e[50]=z):z=e[50];let D;e[51]!==a.quantity||e[52]!==s?(D=t.jsx("div",{children:t.jsx(G,{label:"Quantity",name:"quantity",type:"number",placeholder:"1",value:a.quantity,onChange:xe,icon:_e,disabled:s})}),e[51]=a.quantity,e[52]=s,e[53]=D):D=e[53];let O;e[54]!==P||e[55]!==A||e[56]!==F||e[57]!==q||e[58]!==z||e[59]!==D?(O=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[P,A,F,q,z,D]}),e[54]=P,e[55]=A,e[56]=F,e[57]=q,e[58]=z,e[59]=D,e[60]=O):O=e[60];let K;e[61]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Total Amount"}),e[61]=K):K=e[61];let M;e[62]!==T?(M=t.jsxs("div",{children:[K,t.jsxs("p",{className:"text-3xl font-bold text-amber-500",children:["â‚¹",T]})]}),e[62]=T,e[63]=M):M=e[63];const te=N||T===0,ae=N?"Processing...":s?"Retry Payment":"Proceed to Pay";let V;e[64]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx(fe,{size:18}),e[64]=V):V=e[64];let Y;e[65]!==te||e[66]!==ae?(Y=t.jsxs("button",{type:"submit",disabled:te,className:"flex items-center gap-2 px-8 py-3 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl font-bold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[ae," ",V]}),e[65]=te,e[66]=ae,e[67]=Y):Y=e[67];let $;e[68]!==M||e[69]!==Y?($=t.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-800 flex items-center justify-between",children:[M,Y]}),e[68]=M,e[69]=Y,e[70]=$):$=e[70];let W;return e[71]!==ee||e[72]!==I||e[73]!==O||e[74]!==$?(W=t.jsxs("form",{onSubmit:ee,className:"space-y-6",children:[I,O,$]}),e[71]=ee,e[72]=I,e[73]=O,e[74]=$,e[75]=W):W=e[75],W};function Ae(r){return{...r,quantity:""}}function Fe(r,e){return t.jsxs("option",{value:r.name,children:[r.name," - â‚¹",r.price]},e)}const qe="from-amber-400 via-red-500 to-sky-500",ne=r=>{const e=re.c(8),{children:p,delay:o,className:N}=r,l=o===void 0?0:o,h=N===void 0?"":N;let s,m;e[0]===Symbol.for("react.memo_cache_sentinel")?(s={opacity:0,y:20},m={opacity:1,y:0},e[0]=s,e[1]=m):(s=e[0],m=e[1]);let x;e[2]!==l?(x={duration:.6,delay:l,ease:"easeOut"},e[2]=l,e[3]=x):x=e[3];let c;return e[4]!==p||e[5]!==h||e[6]!==x?(c=t.jsx(J.div,{initial:s,animate:m,transition:x,className:h,children:p}),e[4]=p,e[5]=h,e[6]=x,e[7]=c):c=e[7],c},$e=()=>{const{id:r}=he(),e=ye(),p=ge(),[o,N]=f.useState(null),[l,h]=f.useState(!0),[s,m]=f.useState(!1),[x,c]=f.useState(null),[y,g]=f.useState(null),[b,v]=f.useState(!1),[a,E]=f.useState(null);f.useEffect(()=>{let i=!1;const d=ie(X.PAYMENT_RETRY_CONTEXT);if(d&&(d.isRetry&&d.eventId===r?(v(!0),E({reason:d.lastFailureReason,errorCode:d.lastErrorCode}),i=!0):d.eventId!==r&&localStorage.removeItem(X.PAYMENT_RETRY_CONTEXT)),p.state?.isRetry&&(v(!0),E(p.state?.failureData),i=!0),i){const u=ie(`${X.FORM_DATA_PREFIX}${r}`);u&&g(u)}(async()=>{try{const u=await we(r);u?N(u):c("Event not found")}catch{c("Failed to load event")}finally{h(!1)}})()},[r,p.state]);const T=async i=>{m(!0),c(null);try{if(!i.name.trim()){alert("Please enter your name"),m(!1);return}if(!i.contact.trim()){alert("Please enter your phone number"),m(!1);return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)){alert("Please enter a valid email address"),m(!1);return}const k={eventId:r,formData:i,timestamp:new Date().toISOString()};oe(`${X.FORM_DATA_PREFIX}${r}`,i),oe(X.LAST_PAYMENT_CONTEXT,k);const u=await Te(r,i);if(u.success){const R=await ke.post(`${Re}/api/phonepe/pay`,{name:i.name,amount:i.amount,number:i.contact,mid:"MID"+Date.now(),transactionId:"TXN_"+Date.now(),type:"TICKET",ticketId:u.ticketId,brandName:"Founders Sangam",email:i.email});if(R.data.success){const C=R.data.url;C?window.location.href=C:e("/payment-failure",{state:{data:{reason:"Payment gateway initialization failed",errorCode:"GATEWAY_ERROR",ticketId:u.ticketId,eventId:r,formData:i}}})}else e("/payment-failure",{state:{data:{reason:R.data.message||"Payment initiation failed. Please try again.",errorCode:R.data.errorCode||"PAYMENT_INIT_ERROR",ticketId:u.ticketId,eventId:r,formData:i}}})}else throw new Error("Registration failed initially.")}catch(d){console.error(d);let k="Registration failed";typeof d=="string"?k=d:d.message&&(k=d.message),e("/payment-failure",{state:{data:{reason:k,errorCode:"REGISTRATION_ERROR",eventId:r}}})}};if(l)return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-500"})});if(x||!o)return t.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-white",children:[t.jsx(me,{size:48,className:"text-red-500 mb-4"}),t.jsx("h2",{className:"text-2xl font-bold",children:x||"Event not found"})]});const Z=o.currentRegistrations>=o.maxRegistrations,_=new Date(o.date)<new Date,n=["Registration is non-refundable and open only to confirmed participants.","Event Duration: 2 hours (1 hr Chief guest Session + 1 hr Networking).","Visitors or plus-ones are not allowed inside the venue.","Event videos and photos will be recorded for marketing purposes.","Snacks and refreshments will be provided during the event.","Please take care of your belongings; organizers are not responsible for loss or damage."],S=t.jsx(ne,{delay:0,children:t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 p-4 rounded-xl border border-green-200 dark:border-green-800 shadow-lg ring-2 ring-green-500/50",children:[t.jsxs("h3",{className:"text-lg md:text-xl font-extrabold text-slate-900 dark:text-white mb-2 flex items-center",children:[t.jsx(le,{size:20,className:"text-green-600 dark:text-green-400 mr-2 flex-shrink-0"}),"Claim your place in the most refined FOUNDER circle"]}),t.jsx("div",{className:"space-y-2",children:n.map((i,d)=>t.jsxs("div",{className:"flex items-start text-sm text-slate-700 dark:text-slate-300",children:[t.jsx(le,{size:16,className:"text-green-600 dark:text-green-400 mr-2 mt-0.5 flex-shrink-0"}),t.jsx("span",{className:"leading-relaxed font-medium",children:i})]},d))})]})});return t.jsx("div",{className:"min-h-screen bg-white dark:bg-slate-950 pt-16 pb-10 px-4 md:px-8 transition-colors duration-500",children:t.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-10",children:[t.jsxs(J.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"space-y-6 lg:order-1",children:[t.jsx("div",{className:"hidden lg:block",children:S}),t.jsxs(ne,{delay:.1,className:"relative h-48 md:h-[420px] rounded-xl md:rounded-2xl overflow-hidden shadow-xl",children:[t.jsx("img",{src:o.image||"https://via.placeholder.com/400x800",alt:o.title,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"}),t.jsxs("div",{className:"absolute top-2 left-2 md:top-4 md:left-4 text-white text-xs font-extrabold flex items-center bg-amber-500/80 backdrop-blur-sm px-2 py-0.5 rounded-full",children:[t.jsx(je,{size:12,className:"text-yellow-300 fill-yellow-300 mr-1"}),t.jsx("span",{children:"4.85 Star Rated"})]}),t.jsxs("div",{className:"absolute bottom-3 left-3 md:bottom-5 md:left-5 text-white",children:[t.jsx("h1",{className:"text-base md:text-2xl font-bold mb-1 leading-tight",children:o.title}),t.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-4 text-xs font-light opacity-90",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(ve,{size:12,className:"md:w-3 md:h-3"})," ",new Date(o.date).toLocaleDateString()]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Ne,{size:12,className:"md:w-3 md:h-3"})," ",o.location]})]})]})]}),t.jsxs(ne,{delay:.2,className:"bg-slate-50 dark:bg-slate-900 p-5 rounded-xl border border-slate-100 dark:border-slate-800",children:[t.jsx("h3",{className:"text-lg md:text-xl font-bold text-slate-900 dark:text-white mb-2 md:mb-3",children:"Description"}),t.jsx("p",{className:"text-sm md:text-base text-slate-600 dark:text-slate-400 leading-relaxed line-clamp-4",children:o.description})]})]}),t.jsxs(J.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"lg:order-2",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-5 md:p-6 rounded-xl md:rounded-2xl shadow-xl border border-slate-100 dark:border-slate-700 lg:sticky lg:top-8",children:[t.jsx("div",{className:`h-1.5 w-full bg-gradient-to-r ${qe} absolute top-0 left-0 rounded-t-xl md:rounded-t-2xl`}),t.jsxs("div",{className:"mt-4 mb-4 md:mb-6",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white",children:"Register Now"}),t.jsx("p",{className:"text-sm md:text-base text-slate-500 dark:text-slate-400 mt-1",children:"Secure your spot for this exclusive event."}),b&&a&&t.jsxs(J.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg flex gap-3",children:[t.jsx(Se,{size:20,className:"text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-amber-700 dark:text-amber-300",children:"Payment Retry"}),t.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-0.5",children:"Your details are pre-filled. Adjust if needed and try payment again."})]})]})]}),_?t.jsx("div",{className:"p-6 bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded-xl text-center font-bold text-lg",children:"ðŸ”’ Registration Closed: Event has ended"}):Z?t.jsx("div",{className:"p-6 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-xl text-center font-bold text-lg",children:"ðŸš« Registration Full"}):t.jsxs(t.Fragment,{children:[t.jsx(Pe,{event:o,onSubmit:T,loading:s,savedData:y,isRetry:b}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-slate-400 text-sm",children:[t.jsx(le,{size:16,className:"text-emerald-500"}),t.jsx("span",{children:"Secure Payment via PhonePe"})]})]})]}),t.jsx("div",{className:"block lg:hidden mt-6",children:S})]})]})})};export{$e as default};
